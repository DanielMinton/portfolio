<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GeoStream - Real-time Mapping</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #0a1628;
      color: #fff;
      min-height: 100vh;
      overflow: hidden;
    }
    .container {
      position: relative;
      width: 100%;
      height: 100vh;
    }
    canvas {
      display: block;
      width: 100%;
      height: 100%;
    }
    .overlay {
      position: absolute;
      top: 0;
      left: 0;
      padding: 20px;
      z-index: 10;
    }
    h1 {
      font-size: 1.5rem;
      margin-bottom: 8px;
      background: linear-gradient(90deg, #22c55e, #4ade80);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .subtitle { color: #888; font-size: 0.875rem; margin-bottom: 16px; }
    .panel {
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(10px);
      padding: 16px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.1);
      max-width: 280px;
    }
    .panel-title {
      font-size: 0.75rem;
      color: #888;
      text-transform: uppercase;
      margin-bottom: 12px;
    }
    .event-list {
      max-height: 200px;
      overflow-y: auto;
    }
    .event-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px;
      margin-bottom: 6px;
      background: rgba(255,255,255,0.03);
      border-radius: 6px;
      font-size: 0.75rem;
      animation: slideIn 0.3s ease;
    }
    @keyframes slideIn {
      from { opacity: 0; transform: translateX(-10px); }
      to { opacity: 1; transform: translateX(0); }
    }
    .event-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      flex-shrink: 0;
    }
    .event-dot.green { background: #22c55e; box-shadow: 0 0 8px #22c55e; }
    .event-dot.blue { background: #3b82f6; box-shadow: 0 0 8px #3b82f6; }
    .event-dot.yellow { background: #f59e0b; box-shadow: 0 0 8px #f59e0b; }
    .event-dot.red { background: #ef4444; box-shadow: 0 0 8px #ef4444; }
    .event-info { flex: 1; }
    .event-type { color: #fff; font-weight: 500; }
    .event-location { color: #666; font-size: 0.625rem; }
    .event-time { color: #888; font-size: 0.625rem; }
    .stats {
      position: absolute;
      bottom: 20px;
      left: 20px;
      display: flex;
      gap: 12px;
      z-index: 10;
    }
    .stat {
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(10px);
      padding: 12px 16px;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.1);
    }
    .stat-value {
      font-size: 1.25rem;
      font-weight: 700;
      color: #22c55e;
    }
    .stat-label {
      font-size: 0.625rem;
      color: #888;
      text-transform: uppercase;
    }
    .legend {
      position: absolute;
      bottom: 20px;
      right: 20px;
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(10px);
      padding: 16px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.1);
      z-index: 10;
    }
    .legend-title {
      font-size: 0.75rem;
      color: #888;
      margin-bottom: 8px;
    }
    .legend-item {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.75rem;
      margin-bottom: 4px;
    }
  </style>
</head>
<body>
  <div class="container">
    <canvas id="canvas"></canvas>

    <div class="overlay">
      <h1>GeoStream</h1>
      <p class="subtitle">Real-time geospatial event streaming</p>

      <div class="panel">
        <div class="panel-title">Live Events</div>
        <div class="event-list" id="eventList"></div>
      </div>
    </div>

    <div class="stats">
      <div class="stat">
        <div class="stat-value" id="totalEvents">0</div>
        <div class="stat-label">Total Events</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="eventsPerSec">0</div>
        <div class="stat-label">Events/sec</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="activeRegions">5</div>
        <div class="stat-label">Active Regions</div>
      </div>
    </div>

    <div class="legend">
      <div class="legend-title">Event Types</div>
      <div class="legend-item">
        <div class="event-dot green"></div>
        <span>User Activity</span>
      </div>
      <div class="legend-item">
        <div class="event-dot blue"></div>
        <span>API Request</span>
      </div>
      <div class="legend-item">
        <div class="event-dot yellow"></div>
        <span>Transaction</span>
      </div>
      <div class="legend-item">
        <div class="event-dot red"></div>
        <span>Alert</span>
      </div>
    </div>
  </div>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    let width, height;
    let points = [];
    let connections = [];
    let totalEvents = 0;
    let eventsThisSecond = 0;

    const eventTypes = [
      { type: 'User Login', color: '#22c55e', colorClass: 'green' },
      { type: 'API Request', color: '#3b82f6', colorClass: 'blue' },
      { type: 'Transaction', color: '#f59e0b', colorClass: 'yellow' },
      { type: 'Security Alert', color: '#ef4444', colorClass: 'red' }
    ];

    const locations = [
      { name: 'New York, US', lat: 40.7, lng: -74.0 },
      { name: 'London, UK', lat: 51.5, lng: -0.1 },
      { name: 'Tokyo, JP', lat: 35.7, lng: 139.7 },
      { name: 'Sydney, AU', lat: -33.9, lng: 151.2 },
      { name: 'SÃ£o Paulo, BR', lat: -23.5, lng: -46.6 },
      { name: 'Mumbai, IN', lat: 19.1, lng: 72.9 },
      { name: 'Berlin, DE', lat: 52.5, lng: 13.4 },
      { name: 'Singapore', lat: 1.3, lng: 103.8 },
      { name: 'Dubai, UAE', lat: 25.3, lng: 55.3 },
      { name: 'Toronto, CA', lat: 43.7, lng: -79.4 }
    ];

    // World map points (simplified)
    const worldPoints = [];
    for (let i = 0; i < 200; i++) {
      worldPoints.push({
        x: Math.random(),
        y: Math.random() * 0.6 + 0.2,
        size: 1 + Math.random() * 2,
        alpha: 0.1 + Math.random() * 0.2
      });
    }

    function resize() {
      width = canvas.width = window.innerWidth;
      height = canvas.height = window.innerHeight;
    }

    function latLngToXY(lat, lng) {
      const x = (lng + 180) / 360 * width;
      const y = (90 - lat) / 180 * height;
      return { x, y };
    }

    function createEvent() {
      const eventType = eventTypes[Math.floor(Math.random() * eventTypes.length)];
      const location = locations[Math.floor(Math.random() * locations.length)];
      const pos = latLngToXY(location.lat, location.lng);

      // Add visual point
      points.push({
        x: pos.x,
        y: pos.y,
        color: eventType.color,
        size: 20,
        alpha: 1,
        decay: 0.02
      });

      // Maybe add connection
      if (Math.random() > 0.5 && points.length > 1) {
        const other = points[Math.floor(Math.random() * points.length)];
        connections.push({
          x1: pos.x, y1: pos.y,
          x2: other.x, y2: other.y,
          color: eventType.color,
          alpha: 0.5,
          decay: 0.02
        });
      }

      // Update event list
      const eventList = document.getElementById('eventList');
      const now = new Date();
      const timeStr = now.toLocaleTimeString();

      const eventItem = document.createElement('div');
      eventItem.className = 'event-item';
      eventItem.innerHTML = `
        <div class="event-dot ${eventType.colorClass}"></div>
        <div class="event-info">
          <div class="event-type">${eventType.type}</div>
          <div class="event-location">${location.name}</div>
        </div>
        <div class="event-time">${timeStr}</div>
      `;
      eventList.insertBefore(eventItem, eventList.firstChild);

      // Limit event list
      while (eventList.children.length > 10) {
        eventList.removeChild(eventList.lastChild);
      }

      totalEvents++;
      eventsThisSecond++;
      document.getElementById('totalEvents').textContent = totalEvents.toLocaleString();
    }

    function render() {
      ctx.fillStyle = '#0a1628';
      ctx.fillRect(0, 0, width, height);

      // Draw grid
      ctx.strokeStyle = 'rgba(255,255,255,0.03)';
      ctx.lineWidth = 1;
      for (let x = 0; x < width; x += 50) {
        ctx.beginPath();
        ctx.moveTo(x, 0);
        ctx.lineTo(x, height);
        ctx.stroke();
      }
      for (let y = 0; y < height; y += 50) {
        ctx.beginPath();
        ctx.moveTo(0, y);
        ctx.lineTo(width, y);
        ctx.stroke();
      }

      // Draw world points
      worldPoints.forEach(p => {
        ctx.beginPath();
        ctx.arc(p.x * width, p.y * height, p.size, 0, Math.PI * 2);
        ctx.fillStyle = `rgba(34, 197, 94, ${p.alpha})`;
        ctx.fill();
      });

      // Draw static location markers
      locations.forEach(loc => {
        const pos = latLngToXY(loc.lat, loc.lng);
        ctx.beginPath();
        ctx.arc(pos.x, pos.y, 4, 0, Math.PI * 2);
        ctx.fillStyle = 'rgba(34, 197, 94, 0.5)';
        ctx.fill();

        ctx.beginPath();
        ctx.arc(pos.x, pos.y, 8, 0, Math.PI * 2);
        ctx.strokeStyle = 'rgba(34, 197, 94, 0.3)';
        ctx.stroke();
      });

      // Draw connections
      connections = connections.filter(c => {
        ctx.beginPath();
        ctx.moveTo(c.x1, c.y1);
        ctx.lineTo(c.x2, c.y2);
        ctx.strokeStyle = c.color;
        ctx.globalAlpha = c.alpha;
        ctx.lineWidth = 1;
        ctx.stroke();
        ctx.globalAlpha = 1;

        c.alpha -= c.decay;
        return c.alpha > 0;
      });

      // Draw event points
      points = points.filter(p => {
        // Outer glow
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
        ctx.fillStyle = p.color;
        ctx.globalAlpha = p.alpha * 0.3;
        ctx.fill();

        // Inner point
        ctx.beginPath();
        ctx.arc(p.x, p.y, 3, 0, Math.PI * 2);
        ctx.globalAlpha = p.alpha;
        ctx.fill();

        ctx.globalAlpha = 1;

        p.size += 0.5;
        p.alpha -= p.decay;
        return p.alpha > 0;
      });

      requestAnimationFrame(render);
    }

    // Update events per second
    setInterval(() => {
      document.getElementById('eventsPerSec').textContent = eventsThisSecond;
      eventsThisSecond = 0;
    }, 1000);

    // Generate random events
    setInterval(() => {
      if (Math.random() > 0.3) createEvent();
    }, 200);

    window.addEventListener('resize', resize);
    resize();
    render();

    // Initial events
    for (let i = 0; i < 5; i++) {
      setTimeout(createEvent, i * 100);
    }
  </script>
</body>
</html>
