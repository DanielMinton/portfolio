<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QuantumViz - 3D Data Visualization</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #000;
      color: #fff;
      min-height: 100vh;
      overflow: hidden;
    }
    .container {
      position: relative;
      width: 100%;
      height: 100vh;
    }
    canvas {
      display: block;
      width: 100%;
      height: 100%;
    }
    .overlay {
      position: absolute;
      top: 0;
      left: 0;
      padding: 20px;
      z-index: 10;
    }
    h1 {
      font-size: 1.5rem;
      margin-bottom: 8px;
      background: linear-gradient(90deg, #a855f7, #ec4899);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .subtitle { color: #888; font-size: 0.875rem; margin-bottom: 16px; }
    .controls {
      display: flex;
      flex-direction: column;
      gap: 8px;
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(10px);
      padding: 16px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.1);
    }
    .control-row {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .control-label {
      font-size: 0.75rem;
      color: #888;
      min-width: 80px;
    }
    .btn {
      padding: 8px 16px;
      border-radius: 6px;
      font-size: 0.75rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      border: 1px solid rgba(255,255,255,0.1);
      background: rgba(255,255,255,0.05);
      color: #fff;
    }
    .btn:hover { background: rgba(255,255,255,0.1); }
    .btn.active {
      background: rgba(168, 85, 247, 0.3);
      border-color: #a855f7;
    }
    input[type="range"] {
      width: 120px;
      height: 4px;
      -webkit-appearance: none;
      background: rgba(255,255,255,0.1);
      border-radius: 2px;
      outline: none;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 14px;
      height: 14px;
      background: #a855f7;
      border-radius: 50%;
      cursor: pointer;
    }
    .stats {
      position: absolute;
      bottom: 20px;
      left: 20px;
      display: flex;
      gap: 16px;
      z-index: 10;
    }
    .stat {
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(10px);
      padding: 12px 16px;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.1);
    }
    .stat-value {
      font-size: 1.25rem;
      font-weight: 700;
      color: #a855f7;
    }
    .stat-label {
      font-size: 0.625rem;
      color: #888;
      text-transform: uppercase;
    }
    .legend {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(10px);
      padding: 16px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.1);
      z-index: 10;
    }
    .legend-title {
      font-size: 0.75rem;
      color: #888;
      margin-bottom: 8px;
    }
    .legend-item {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.75rem;
      margin-bottom: 4px;
    }
    .legend-color {
      width: 12px;
      height: 12px;
      border-radius: 3px;
    }
  </style>
</head>
<body>
  <div class="container">
    <canvas id="canvas"></canvas>

    <div class="overlay">
      <h1>QuantumViz</h1>
      <p class="subtitle">Interactive 3D data point cloud visualization</p>

      <div class="controls">
        <div class="control-row">
          <span class="control-label">Shape</span>
          <button class="btn active" data-shape="sphere" onclick="setShape('sphere')">Sphere</button>
          <button class="btn" data-shape="cube" onclick="setShape('cube')">Cube</button>
          <button class="btn" data-shape="helix" onclick="setShape('helix')">Helix</button>
        </div>
        <div class="control-row">
          <span class="control-label">Particles</span>
          <input type="range" id="particleCount" min="500" max="5000" value="2000" onchange="updateParticles()">
          <span id="particleValue">2000</span>
        </div>
        <div class="control-row">
          <span class="control-label">Speed</span>
          <input type="range" id="speed" min="1" max="10" value="3" onchange="updateSpeed()">
        </div>
      </div>
    </div>

    <div class="legend">
      <div class="legend-title">Data Clusters</div>
      <div class="legend-item">
        <div class="legend-color" style="background: #a855f7;"></div>
        <span>High Activity</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background: #ec4899;"></div>
        <span>Medium Activity</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background: #06b6d4;"></div>
        <span>Low Activity</span>
      </div>
    </div>

    <div class="stats">
      <div class="stat">
        <div class="stat-value" id="fps">60</div>
        <div class="stat-label">FPS</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="points">2,000</div>
        <div class="stat-label">Points</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="render">2.1ms</div>
        <div class="stat-label">Render</div>
      </div>
    </div>
  </div>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    let width, height;
    let particles = [];
    let currentShape = 'sphere';
    let particleCount = 2000;
    let rotationSpeed = 0.003;
    let rotationX = 0;
    let rotationY = 0;
    let mouseX = 0;
    let mouseY = 0;
    let lastTime = performance.now();
    let frameCount = 0;

    const colors = ['#a855f7', '#ec4899', '#06b6d4', '#22c55e', '#f59e0b'];

    function resize() {
      width = canvas.width = window.innerWidth;
      height = canvas.height = window.innerHeight;
    }

    function createParticles() {
      particles = [];
      for (let i = 0; i < particleCount; i++) {
        let x, y, z;

        if (currentShape === 'sphere') {
          const theta = Math.random() * Math.PI * 2;
          const phi = Math.acos(2 * Math.random() - 1);
          const r = 150 + Math.random() * 50;
          x = r * Math.sin(phi) * Math.cos(theta);
          y = r * Math.sin(phi) * Math.sin(theta);
          z = r * Math.cos(phi);
        } else if (currentShape === 'cube') {
          x = (Math.random() - 0.5) * 300;
          y = (Math.random() - 0.5) * 300;
          z = (Math.random() - 0.5) * 300;
        } else if (currentShape === 'helix') {
          const t = (i / particleCount) * Math.PI * 8;
          const r = 100 + Math.random() * 30;
          x = r * Math.cos(t);
          y = (i / particleCount - 0.5) * 400;
          z = r * Math.sin(t);
        }

        particles.push({
          x, y, z,
          ox: x, oy: y, oz: z,
          color: colors[Math.floor(Math.random() * colors.length)],
          size: 1.5 + Math.random() * 2
        });
      }
    }

    function rotatePoint(x, y, z) {
      // Rotate around Y axis
      let cosY = Math.cos(rotationY);
      let sinY = Math.sin(rotationY);
      let x1 = x * cosY - z * sinY;
      let z1 = x * sinY + z * cosY;

      // Rotate around X axis
      let cosX = Math.cos(rotationX);
      let sinX = Math.sin(rotationX);
      let y1 = y * cosX - z1 * sinX;
      let z2 = y * sinX + z1 * cosX;

      return { x: x1, y: y1, z: z2 };
    }

    function project(x, y, z) {
      const fov = 500;
      const scale = fov / (fov + z);
      return {
        x: x * scale + width / 2,
        y: y * scale + height / 2,
        scale
      };
    }

    function render() {
      const startTime = performance.now();

      ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
      ctx.fillRect(0, 0, width, height);

      // Update rotation based on mouse
      rotationY += rotationSpeed + (mouseX - width / 2) * 0.00001;
      rotationX += (mouseY - height / 2) * 0.00001;

      // Sort particles by z-depth
      const sortedParticles = particles.map(p => {
        const rotated = rotatePoint(p.x, p.y, p.z);
        return { ...p, ...rotated };
      }).sort((a, b) => b.z - a.z);

      // Draw particles
      sortedParticles.forEach(p => {
        const projected = project(p.x, p.y, p.z);
        const alpha = Math.max(0.2, Math.min(1, (p.z + 200) / 400));
        const size = p.size * projected.scale;

        ctx.beginPath();
        ctx.arc(projected.x, projected.y, size, 0, Math.PI * 2);
        ctx.fillStyle = p.color;
        ctx.globalAlpha = alpha;
        ctx.fill();
      });

      ctx.globalAlpha = 1;

      // Update stats
      frameCount++;
      const now = performance.now();
      if (now - lastTime >= 1000) {
        document.getElementById('fps').textContent = frameCount;
        frameCount = 0;
        lastTime = now;
      }

      const renderTime = performance.now() - startTime;
      document.getElementById('render').textContent = renderTime.toFixed(1) + 'ms';

      requestAnimationFrame(render);
    }

    function setShape(shape) {
      currentShape = shape;
      document.querySelectorAll('[data-shape]').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.shape === shape);
      });
      createParticles();
    }

    function updateParticles() {
      particleCount = parseInt(document.getElementById('particleCount').value);
      document.getElementById('particleValue').textContent = particleCount;
      document.getElementById('points').textContent = particleCount.toLocaleString();
      createParticles();
    }

    function updateSpeed() {
      rotationSpeed = document.getElementById('speed').value * 0.001;
    }

    canvas.addEventListener('mousemove', (e) => {
      mouseX = e.clientX;
      mouseY = e.clientY;
    });

    window.addEventListener('resize', resize);

    resize();
    createParticles();
    render();
  </script>
</body>
</html>
